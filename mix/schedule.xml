<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE schedules [
	<!ELEMENT schedules (schedule|activity)+>
	<!ELEMENT schedule (#PCDATA)>
	<!ELEMENT activity (init,repeat?,end)>

	<!ATTLIST schedule
    name ID #REQUIRED
  >

	<!ATTLIST activity
    name ID #REQUIRED
  >

	<!ELEMENT init (script)>
	<!ELEMENT repeat (script)>
	<!ELEMENT end (script)>

	<!ELEMENT script (#PCDATA)>
	<!ATTLIST script type CDATA #FIXED "text/javascript">
]>

<schedules>
	<schedule name="villager">
		<![CDATA[
0000: Sleep
	range: "+-30"
0630: Wander
	range: "+30"
1700: GoHome
	range: "+30"
    ]]>
	</schedule>

	<activity name="GoHome">
		<init>
			<script type="text/javascript">
				<![CDATA[
			scheduler.AddTask(new Task(TaskType.FindAndGoto, "Bed_" + this.Name.ToID()));
			scheduler.AddTask(new Task(TaskType.Wander, 500));
        ]]>
			</script>
		</init>
		<repeat>
			<script type="text/javascript">
				<![CDATA[
			scheduler.AddTask(new Task(TaskType.Wander, 30000));
        ]]>
			</script>
		</repeat>
		<end>
			<script type="text/javascript">
				<![CDATA[
			
        ]]>
			</script>
		</end>
	</activity>

	<activity name="Sleep">
		<init>
			<script type="text/javascript">
				<![CDATA[
			scheduler.AddTask(new Task(TaskType.FindAndGoto, "Bed_" + this.Name.ToID()));
			
			var token = new Token("sleeping");
		
			if (!this.HasToken("sleeping"))
				scheduler.AddTask(new Task(TaskType.AddToken, token));
        ]]>
			</script>
		</init>
		<end>
			<script type="text/javascript">
				<![CDATA[
			scheduler.AddTask(new Task(TaskType.RemoveToken, "sleeping"));
        ]]>
			</script>
		</end>
	</activity>

	<activity name="Wander">
		<init>
			<script type="text/javascript">
				<![CDATA[
			scheduler.AddTask(new Task(TaskType.Wander, -1));
        ]]>
			</script>
		</init>
		<end>
			<script type="text/javascript">
				<![CDATA[
			scheduler.AddTask(new Task(TaskType.Wander, Math.ceil(Math.random() * 5)));
        ]]>
			</script>
		</end>
	</activity>
</schedules>